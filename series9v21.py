from group45 import*

def calc9(k,c1):
    p = k.p
    q1 = init2(10)
    q2 = init2(10)
    q3 = init2(10)
    q4 = init2(10)
    if (c1==2):
        e1 = (p-1)//9
        e = e1**2
        a3 = exp2a(e//2,k.a2,p)
        a4 = exp2a(4,a3,p)
        a5 = exp2a(16,a3,p)
        t1 = (p+1)//2
        a3[0] = t1*a3[0]%p
        a3[1] = t1*a3[1]%p
        a4[0] = t1*a4[0]%p
        a4[1] = t1*a4[1]%p
        a5[0] = t1*a5[0]%p
        a5[1] = t1*a5[1]%p
        t1 = (2*a3[0]+a4[0])%p
        t2 = (2*a3[1]+a4[1])%p
        t3 = (a3[0]+a4[0])%p
        t4 = (a3[1]+a4[1])%p
        t5 = 0
        t6 = 0
        t7 = (a4[0]+2*a5[0])%p
        t8 = (a4[1]+2*a5[1])%p
        t9 = a5[0]
        t10 = a5[1]
        q1 = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10]
        t2 = (p-t2)%p
        t4 = (p-t4)%p
        t6 = (p-t6)%p
        t8 = (p-t8)%p
        t10 = (p-t10)%p
        q2 = [t2,t1,t4,t3,t6,t5,t8,t7,t10,t9]

        t1 = (2*a3[0]+(p-1)*a4[0])%p
        t2 = (2*a3[1]+(p-1)*a4[1])%p
        t3 = ((p-1)*a3[0]+(p-1)*a4[0])%p
        t4 = ((p-1)*a3[1]+(p-1)*a4[1])%p
        t5 = ((p-1)*a3[0]+a4[0]+a5[0])%p
        t6 = ((p-1)*a3[1]+a4[1]+a5[1])%p
        t7 = a4[0]
        t8 = a4[1]
        t9 = (p-a5[0])%p
        t10 = (p-a5[1])%p
        q4 = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10]
        t1 = (p-t1)%p
        t3 = (p-t3)%p
        t5 = (p-t5)%p
        t7 = (p-t7)%p
        t9 = (p-t9)%p
        q3 = [t2,t1,t4,t3,t6,t5,t8,t7,t10,t9]
   
    if (c1==4):
        e1 = 2*(p-1)//9
        e = e1**2
        a3 = exp2a(e//2,k.a2,p)
        a4 = exp2a(4,a3,p)
        a5 = exp2a(16,a3,p)
        t1 = (p+1)//2
        a3[0] = t1*a3[0]%p
        a3[1] = t1*a3[1]%p
        a4[0] = t1*a4[0]%p
        a4[1] = t1*a4[1]%p
        a5[0] = t1*a5[0]%p
        a5[1] = t1*a5[1]%p
        t1 = (2*a3[0]+a4[0]+2*a5[0])%p
        t2 = (2*a3[1]+a4[1]+2*a5[1])%p
        t3 = (2*a3[0]+2*a4[0]+2*a5[0])%p
        t4 = (2*a3[1]+2*a4[1]+2*a5[1])%p
        t5 = (a3[0]+2*a4[0]+2*a5[0])%p
        t6 = (a3[1]+2*a4[1]+2*a5[1])%p
        t7 = (2*a3[0]+2*a4[0]+a5[0])%p
        t8 = (2*a3[1]+2*a4[1]+a5[1])%p
        t9 = (a3[0]+a4[0]+a5[0])%p
        t10 = (a3[1]+a4[1]+a5[1])%p
        q1 = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10]
        t2 = (p-t2)%p
        t4 = (p-t4)%p
        t6 = (p-t6)%p
        t8 = (p-t8)%p
        t10 = (p-t10)%p
        q2 = [t2,t1,t4,t3,t6,t5,t8,t7,t10,t9]

        t1 = (2*a3[0]+(p-1)*a4[0]+(p-2)*a5[0])%p
        t2 = (2*a3[1]+(p-1)*a4[1]+(p-2)*a5[1])%p
        t3 = (2*a3[0])%p
        t4 = (2*a3[1])%p
        t5 = (p-a3[0])%p
        t6 = (p-a3[1])%p
        t7 = ((p-2)*a3[0]+a5[0])%p
        t8 = ((p-2)*a3[1]+a5[1])%p
        t9 = ((p-1)*a3[0]+a4[0]+a5[0])%p
        t10 = ((p-1)*a3[1]+a4[1]+a5[1])%p
        q4 = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10]
        t1 = (p-t1)%p
        t3 = (p-t3)%p
        t5 = (p-t5)%p
        t7 = (p-t7)%p
        t9 = (p-t9)%p
        q3 = [t2,t1,t4,t3,t6,t5,t8,t7,t10,t9]

    return(q1,q2,q3,q4)       



p1 = [1657,1801,2953,6841,7489]
p = p1[4]  
k = group(0,p)

flag4 = 0
k = group(exp1(1,k.g,p),p)
k1 = group(exp1(9,k.g,p),p)
k2 = group(exp1(81,k.g,p),p)

k.list2(9,2)
k1.list1(3,2,(p-1)//18)
k2.list1(9,2,(p-1)//18)

s1 = k.calc29(1,2,1*(p-1)//2,p)
s2 = k2.calc29(1,2,1*(p-1)//18,p)

k20 = init2(20)

for i in range(5):
    h1 = k.series(s1[2*i],s1[2*i+1],0,2)
    k20[2*i] = h1[0]
    k20[2*i+1] = h1[1]
    h2 = k2.series(s2[2*i],s2[2*i+1],0,2)
    k20[2*i+10] = h2[0]
    k20[2*i+11] = h2[1]   

print("\n \n s1 = ",s1)
print("\n \n s2 = ",s2)
print("\n \n k20 = ",k20)

m = init1(30,20)

m[0] = [p-2,2,p-2,2,p-2,2,p-2,2,p-1,1,
        0,0,0,0,0,0,0,0,0,0]

m[1] = [0,0,0,0,0,0,0,0,0,0,
        p-2,2,p-2,2,p-2,2,p-2,2,p-1,1]

if flag4==1:
    
    m[0] = [p-2,p-2,p-2,p-2,p-2,p-2,p-2,p-2,p-1,p-1,
            0,0,0,0,0,0,0,0,0,0]

    m[1] = [0,0,0,0,0,0,0,0,0,0,
            p-2,p-2,p-2,p-2,p-2,p-2,p-2,p-2,p-1,p-1]
    

m[2] = [0,2,0,2,0,2,0,2,0,1,
        0,p-6,0,p-6,0,p-6,0,p-6,0,p-3]

m[3] = [p-1,0,0,0,p-1,0,p-1,0,0,0,
        3,0,0,0,3,0,3,0,0,0] 

m[4] = [0,p-1,0,0,0,p-1,0,p-1,0,0,
        0,3,0,0,0,3,0,3,0,0]


m[5] = [0,0,2,0,0,0,0,0,1,0,
        0,0,p-6,0,0,0,0,0,p-3,0] 

m[6] = [0,0,0,2,0,0,0,0,0,1,
        0,0,0,p-6,0,0,0,0,0,p-3] 


e = (p-1)//18
h1 = k.series(1,e,4*e,2)
h2 = k.series(1,e,8*e,2)
h3 = k.series(1,e,16*e,2)
t1 = (h1[0]+h2[0]+h3[0])%p
t2 = (h1[1]+h2[1]+h3[1])%p
h4 = [t1,t2,0,0]
print("\n \n h4 = ",h4)

a3 = exp2a(2*e*e,k.a2,p)
a4 = exp2a(4,a3,p)
a5 = exp2a(16,a3,p)
t1 = (p+1)//2
c1 = t1*a3[0]%p
s1 = t1*a3[1]%p
c2 = t1*a4[0]%p
s2 = t1*a4[1]%p
c3 = t1*a5[0]%p
s3 = t1*a5[1]%p

m[8] = [c1+2*c3,s1+2*s3,    c1+c3,s1+s3,     c1+c2+c3,s1+s2+s3,
        c1+2*c2,s1+2*s2,    c2,s2,
        0,0,0,0,0,0,0,0,0,0]

t = 3*(p+1)//2
t = t%p
m[20] = [0,0,0,0,0,0,0,0,0,0,
        2*t,0,0,0,p-t,0,p-t,0,0,0]

c1,s1 = p-s1,c1
c2,s2 = p-s2,c2
c3,s3 = p-s3,c3


m[9] = [c1+2*c3,s1+2*s3,    c1+c3,s1+s3,     c1+c2+c3,s1+s2+s3,
        c1+2*c2,s1+2*s2,    c2,s2,
        0,0,0,0,0,0,0,0,0,0]


t = 3*(p+1)//2
t = t%p
m[21] = [0,0,0,0,0,0,0,0,0,0,
        0,2*t,0,0,0,p-t,0,p-t,0,0]


e = (p-1)//9
h1 = k.series(1,e,2*e,2)
h2 = k.series(1,e,4*e,2)
h3 = k.series(1,e,8*e,2)
t3 = (h1[0]+h2[0]+h3[0])%p
t4 = (h1[1]+h2[1]+h3[1])%p
t5 = (h1[2]+(p-1)*h2[2]+h3[2])%p
t6 = (h1[3]+(p-1)*h2[3]+h3[3])%p
h5 = [t3,t4,t5,t6]
print("\n \n h5 = ",h5)

t = 3*(p+1)//2
t = t%p
m[22] = [0,0,0,0,0,0,0,0,0,0,
        2*t%p,0,t,0,p-t,0,p-t,0,p-t,0]

m[23] = [0,0,0,0,0,0,0,0,0,0,
         0,2*t%p,0,t,0,p-t,0,p-t,0,p-t]


e1 = (p-1)//9
a3 = exp2a(3*e**2,k.a2,p)
s3 = 2*a3[1]%p
s3 = (p-s3)%p

t = 3*s3*(p+1)//2
t = t%p
t = (p-t)
m[24] = [0,0,0,0,0,0,0,0,0,0,
         0,0,t,0,t,0,p-t,0,p-t,0]

m[25] = [0,0,0,0,0,0,0,0,0,0,
         0,0,0,t,0,t,0,p-t,0,p-t]



m[10],m[11],m[12],m[13] = calc9(k,2)

t1 = init2(10)
m[10] = m[10]+t1[:]
m[11] = m[11]+t1[:]
m[12] = m[12]+t1[:]
m[13] = m[13]+t1[:]

t1 = p-1
for i in range(0,10):
    m[8][i+10] = t1*m[20][i+10]%p
    m[9][i+10] = t1*m[21][i+10]%p
    m[10][i+10] = t1*m[22][i+10]%p
    m[11][i+10] = t1*m[23][i+10]%p
    m[12][i+10] = t1*m[24][i+10]%p
    m[13][i+10] = t1*m[25][i+10]%p



e = 2*(p-1)//9
h1 = k.series(1,e,2*e,2)
h2 = k.series(1,e,4*e,2)
h3 = k.series(1,e,8*e,2)
t3 = (h1[0]+h2[0]+h3[0])%p
t4 = (h1[1]+h2[1]+h3[1])%p
t5 = (h1[2]+(p-1)*h2[2]+h3[2])%p
t6 = (h1[3]+(p-1)*h2[3]+h3[3])%p
h6 = [t3,t4,t5,t6]
print("\n \n h6 = ",h6)
t1 = 3*(p+1)//2
t1 = t1%p
t2 = (p-t1)%p
m[26] = [0,0,0,0,0,0,0,0,0,0,
         0,0,t1,0,0,0,0,0,t2,0]

m[27] = [0,0,0,0,0,0,0,0,0,0,
         0,0,0,t1,0,0,0,0,0,t2]


t1 = 3*s3*(p+1)//2
t1 = t%p
t2 = (p-t1)
m[28] = [0,0,0,0,0,0,0,0,0,0,
         2*t2,0,t2,0,0,0,2*t1,0,t1,0]

m[29] = [0,0,0,0,0,0,0,0,0,0,
         0,2*t2,0,t2,0,0,0,2*t1,0,t1]


m[14],m[15],m[16],m[17] = calc9(k,4)

t1 = init2(10)
m[14] = m[14]+t1[:]
m[15] = m[15]+t1[:]
m[16] = m[16]+t1[:]
m[17] = m[17]+t1[:]



t1 = p-1
for i in range(0,10):
    m[14][i+10] = t1*m[26][i+10]%p
    m[15][i+10] = t1*m[27][i+10]%p
    m[16][i+10] = t1*m[28][i+10]%p
    m[17][i+10] = t1*m[29][i+10]%p



sq3 = s3


m[8] = init2(20)
m[9] = init2(20)


# test 1
e = (p-1)//9
h1 = k.series(e//4,5*e//4,e,2)
h2 = k.series(e//4,5*e//4,5*e,2)
h3 = k.series(e//4,5*e//4,7*e,2)
t1 = 2*(h1[2]+(p-1)*h2[2]+h3[2])%p
t2 = 2*(h1[3]+(p-1)*h2[3]+h3[3])%p
print("\n \n ^^^^^^^^^^^^^^ t1 = {0}  t2 = {1}".format(t1,t2))
h4 = k.series1(46+2,5*46,9,0,2)
h5 = k.series1(46+5,5*46,9,0,2)
t3 = 3*sq3*((p-1)*h4[0]+h5[0])%p
t4 = 3*sq3*((p-1)*h4[1]+h5[1])%p
print("\n \n ^^^^^^^^^^^^^^ t3 = {0}  t4 = {1}".format(t3,t4))

e1 = e*e//8
a20 = exp2a(e1,k.a2,p)
a21 = exp2a(25,a20,p)
a22 = exp2a(49,a20,p)
c1,s01 = a20[0],a20[1]
c2,s02 = a21[0],a21[1]
c3,s03 = a22[0],a22[1]

t1 = (c1+(p-1)*c2)%p
t2 = (s01+(p-1)*s02)%p
t3 = ((p-1)*c2+c3)%p
t4 = ((p-1)*s02+s03)%p
t5 = ((p-1)*c1+c3)%p
t6 = ((p-1)*s01+s03)%p
t7 = (c2+(p-1)*c3)%p
t8 = (s02+(p-1)*s03)%p
t9 = t7
t10 = t8

c = 3*s3%p
c = (p+c)%p
m[8] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
        2*c,0, 0,0, (p-c)%p,0, (p-c)%p,0, 0,0]

m[8] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
        0,2*c, 0,0, 0,(p-c)%p, 0,(p-c)%p, 0,0]




# test 2
e = (p-1)//18
h1 = k.series(e//4,5*e//4,e,2)
h2 = k.series(e//4,5*e//4,5*e,2)
h3 = k.series(e//4,5*e//4,7*e,2)
t5 = 2*(h1[2]+(p-1)*h2[2]+h3[2])%p
t6 = 2*(h1[3]+(p-1)*h2[3]+h3[3])%p
print("\n \n ^^^^^^^^^^^^^^ t5 = {0}  t6 = {1}".format(t5,t6))
h4 = k.series1(23+1,5*23,18,0,2)
h5 = k.series1(23+7,5*23,18,0,2)
h6 = k.series1(23+10,5*23,18,0,2)
h7 = k.series1(23+16,5*23,18,0,2)
t7 = 3*sq3*((p-1)*h4[0]+h5[0]+h6[0]+(p-1)*h7[0])%p
t8 = 3*sq3*((p-1)*h4[1]+h5[1]+h6[1]+(p-1)*h7[1])%p
print("\n \n ^^^^^^^^^^^^^^ t7 = {0}  t8 = {1}".format(t7,t8))

t9 = 2*(h1[0]+h2[0]+h3[0])%p
t10 = 2*(h1[1]+h2[1]+h3[1])%p
print("\n \n ^^^^^^^^^^^^^^ t9 = {0}  t10 = {1}".format(t9,t10))


t11 = 2*(h1[2]+(p-1)*h2[2]+h3[2])%p
t12 = 2*(h1[3]+(p-1)*h2[3]+h3[3])%p
print("\n \n ^^^^^^^^^^^^^^ t11 = {0}  t12 = {1}".format(t11,t12))



e1 = e*e//8
a20 = exp2a(e1,k.a2,p)
a21 = exp2a(25,a20,p)
a22 = exp2a(49,a20,p)
t = (p+1)//1
c1,s1 = t*a20[0]%p,t*a20[1]%p
c2,s2 = t*a21[0]%p,t*a21[1]%p
c3,s3 = t*a22[0]%p,t*a22[1]%p

t1 = (c1+c2)%p
t2 = (s1+s2)%p
t3 = 0
t4 = 0
t5 = (c2+c3)%p
t6 = (s2+s3)%p
t7 = (c1+c3)%p
t8 = (s1+s3)%p
t9 = 0
t10 = 0


"""
t1 = (c1+(p-1)*c2)%p
t2 = (s1+(p-1)*s2)%p
t3 = 0
t4 = 0
t5 = (c2+(p-1)*c3)%p
t6 = (s2+(p-1)*s3)%p
t7 = ((p-1)*c1+c3)%p
t8 = ((p-1)*s1+s3)%p
t9 = 0
t10 = 0
"""


t = 3*sq3%p
# t = p-t
t = 3
m[7] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
        
      #   0,0,0,0,0,0,0,0,0,0]
        
      0,0, t,0, 0,0, 0,0, p-t,0]
        
       # 0,0, 0,t, 0,0, 0,0, 0,p-t]


"""
m[8] = [0,0,0,0,0,0,0,0,0,0,
       0,0, p-t,0, 0,0, 0,0, t,0]


m[9] = [0,0,0,0,0,0,0,0,0,0,
      0,0, 0,p-t, 0,0, 0,0, 0,t]
"""



"""
t = 3
m[8] = [0,0,0,0,0,0,0,0,0,0,
       0,0, t,0, 0,0, 0,0, p-t,0]


m[9] = [0,0,0,0,0,0,0,0,0,0,
      0,0, 0,p-t, 0,0, 0,0, 0,t]
"""






# test 3

e = (p-1)//36
h1 = k.series(0,e,4*e,2)
h2 = k.series(0,e,8*e,2)
h3 = k.series(0,e,16*e,2)

t13 = 2*(h1[0]+h2[0]+h3[0])%p
t14 = 2*(h1[1]+h2[1]+h3[1])%p
print("\n \n ^^^^^^^^^^^^^^ t13 = {0}  t14 = {1}".format(t13,t14))


t15 = 2*(h1[2]+(p-1)*h2[2]+h3[2])%p
t16 = 2*(h1[3]+(p-1)*h2[3]+h3[3])%p
print("\n \n ^^^^^^^^^^^^^^ t15 = {0}  t16 = {1}".format(t15,t16))



e1 = 2*e*e
a20 = exp2a(e1,k.a2,p)
a21 = exp2a(4,a20,p)
a22 = exp2a(16,a20,p)
t = (p+1)//1
c1,s1 = t*a20[0]%p,t*a20[1]%p
c2,s2 = t*a21[0]%p,t*a21[1]%p
c3,s3 = t*a22[0]%p,t*a22[1]%p

t1 = c1
t2 = s1
t3 = 0
t4 = 0
t5 = c3
t6 = s3
t7 = c2
t8 = s2
t9 = 0
t10 = 0



m[7] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
        
        0,0, 3,0, 0,0, 0,0, p-3,0]



t = p-3
m[8] = [0,0,0,0,0,0,0,0,0,0,
       0,0, t,0, 0,0, 0,0, p-t,0]


m[9] = [0,0,0,0,0,0,0,0,0,0,
      0,0, 0,t, 0,0, 0,0, 0,p-t]






t1 = ((p-1)*c1+(p-2)*c2+2*c3)%p
t2 = ((p-1)*s1+(p-2)*s2+2*s3)%p
t3 = 2*c3%p
t4 = 2*s3%p
t5 = (p-c3)%p
t6 = (p-s3)%p
t7 = (c2+(p-2)*c3)%p
t8 = (s2+(p-2)*s3)%p
t9 = (c1+c2+(p-1)*c3)%p
t10 = (s1+s2+(p-1)*s3)%p


c = 1
s1 = (p-6)*c*sq3%p
s2 = (p-3)*c*sq3%p
s3 = 6*c*sq3%p
s4 = 3*c*sq3%p
m[7] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
        
        0,s1, 0,s2, 0,0, 0,s3, 0,s4]



t1 = 3*sq3%p
t2 = p-t1

m[8] = [0,0,0,0,0,0,0,0,0,0,
        2*t1,0, t1,0, 0,0, 2*t2,0, t2,0]


m[9] = [0,0,0,0,0,0,0,0,0,0,
        0,2*t1, 0,t1, 0,0, 0,2*t2, 0,t2]





# m[8] = init2(20)
# m[9] = init2(20)










"""
e = (p-1)//72
h1 = k.series(1,e,12*e,2)
h2 = k.series(8*e,9*e,0,2)

t1 = (2*h1[0]+h2[0])%p
t2 = (2*h1[1]+h2[1])%p
print("\n \n &&&&&&&&&&&&&&&&&   t1 = ",t1," t2 = ",t2)


m[7] = [2,0, p-2,0, 2,0, 2,0, p-1,0,
        0,0, 0,0, 0,0, 0,0, 0,0]
"""





"""
t1 = 3*inverse(4,p)%p
t2 = p-t1

t1,t2 = 2*t1%p , 2*t2%p
t1,t2 = t2,t1

m[8] = [1,0,   p-1,0,   1,0, 1,0,  (p-1)//2,0,
        2*t1,0,   2*t2,0,   2*t1,0,   2*t1,0,  t2,0]


m[9] = [0,0,   0,0,   0,0, 0,0,  0,0,
        0,2*t1,   0,2*t2,   0,2*t1,   0,2*t1,  0,t2]
"""


# m[7] = init2(20)

# m[8] = init2(20)

# m[9] = init2(20)
        


# test 4
"""
t = 9*inverse(4,p)%p
            
m[7] = [430,1011,  828,0,   1570,203,  1314,443,  414,0,
        
         0,0,  t,0,  0,0,  0,0,  0,0]
        
    

m[8] = [0,0, 0,0, 0,0, 0,0, 0,0,
       0,0, p-t,0, 0,0, 0,0, 0,0]




m[9] = [0,0, 0,0, 0,0, 0,0, 0,0,
        0,0, 0,p-t, 0,0, 0,0, 0,0]
"""




# test 5

# (1)

e = (p-1)//18
h1 = k.series(0,e//4,e,2)
h2 = k.series(0,3*e//4,e,2)
h3 = k.series(0,e//4,5*e,2)
h4 = k.series(0,3*e//4,5*e,2)
h5 = k.series(0,e//4,7*e,2)
h6 = k.series(0,3*e//4,7*e,2)

h1[0] = (h1[0]+h2[0])%p
h1[1] = (h1[1]+h2[1])%p

h3[0] = (h3[0]+h4[0])%p
h3[1] = (h3[1]+h4[1])%p

h5[0] = (h5[0]+h6[0])%p
h5[1] = (h5[1]+h6[1])%p

t20 = 2*(h1[0]+(p+1)*h3[0]+h5[0])%p
t21 = 2*(h1[1]+(p+1)*h3[1]+h5[1])%p
print("\n \n ^^^^^^^^^^^^^^ t20 = {0}  t21 = {1}".format(t20,t21))


t = p-1
h1[2] = (t*h1[2]+h2[2])%p
h1[3] = (t*h1[3]+h2[3])%p

h3[2] = (t*h3[2]+h4[2])%p
h3[3] = (t*h3[3]+h4[3])%p

h5[2] = (t*h5[2]+h6[2])%p
h5[3] = (t*h5[3]+h6[3])%p


t22 = 2*(h1[2]+(p-1)*h3[2]+h5[2])%p
t23 = 2*(h1[3]+(p-1)*h3[3]+h5[3])%p
print("\n \n ^^^^^^^^^^^^^^ t22 = {0}  t23 = {1}".format(t22,t23))



e1 = e*e//8
a20 = exp2a(e1,k.a2,p)
a21 = exp2a(25,a20,p)
a22 = exp2a(49,a20,p)
c1,s01 = a20[0],a20[1]
c2,s02 = a21[0],a21[1]
c3,s03 = a22[0],a22[1]

t1 = c1
t2 = s01
t3 = (c2+c3)%p
t4 = (s02+s03)%p
t5 = c3
t6 = s03
t7 = c2
t8 = s02
t9 = 1*c1%p
t10 = 1*s01%p


c = 3*s3%p
c = (p+c)%p
t = p-3
t = p-3
m[7] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
         0,t, 0,0, 0,(p-2)*t%p, 0,t, 0,0]
        # p-t,0,  0,0, 2*t%p,0,  p-t,0,  0,0]



c1,s01 = p-s01,c1
c2,s02 = p-s02,c2
c3,s03 = p-s03,c3

t1 = c1
t2 = s01
t3 = (c2+c3)%p
t4 = (s02+s03)%p
t5 = c3
t6 = s03
t7 = c2
t8 = s02
t9 = 1*c1%p
t10 = 1*s01%p



t = 3
m[8] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
       0,t, 0,0, 0,(p-2)*t%p, 0,t, 0,0]


       



t = 3*sq3%p
t = 3
m[8] = [0,0, 0,0, 0,0, 0,0, 0,0,
       t,0, 0,0, (p-2)*t,0, t,0, 0,0]




m[9] = [0,0, 0,0, 0,0, 0,0, 0,0,
        0,t, 0,0, 0,(p-2)*t, 0,t, 0,0]






# (2)

e1 = e*e//8
a20 = exp2a(e1,k.a2,p)
a21 = exp2a(25,a20,p)
a22 = exp2a(49,a20,p)
c1,s01 = a20[0],a20[1]
c2,s02 = a21[0],a21[1]
c3,s03 = a22[0],a22[1]


t1 = (p-c1)%p
t2 = (p-s01)%p
t3 = (c2+c3)%p
t4 = (s02+s03)%p
t5 = (p-c3)%p
t6 = (p-s03)%p
t7 = (p-c2)%p
t8 = (p-s02)%p
t9 = c1
t10 = s01

t = 3*sq3%p
t = (p+t)%p
m[7] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
    
        t,0,  0,0, 0,0,  p-t,0,  0,0]



c1,s01 = s01,p-c1
c2,s02 = s02,p-c2
c3,s03 = s03,p-c3


t1 = (p-c1)%p
t2 = (p-s01)%p
t3 = (c2+c3)%p
t4 = (s02+s03)%p
t5 = (p-c3)%p
t6 = (p-s03)%p
t7 = (p-c2)%p
t8 = (p-s02)%p
t9 = c1
t10 = s01

t = 3*sq3%p
t = (p-t)%p
m[8] = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,
    
        0,t,  0,0, 0,0,  0,p-t,  0,0]




"""
t = 3*sq3%p
m[8] = [0,0, 0,0, 0,0, 0,0, 0,0,
       t,0, 0,0,  0,0, p-t,0, 0,0]




m[9] = [0,0, 0,0, 0,0, 0,0, 0,0,
        0,t, 0,0, 0,0, 0,p-t, 0,0]
"""




# m[8] = init2(20)

m[9] = init2(20)








# test 6

e = (p-1)//18
h1 = k.series(e//4,5*e//4,3*e,2)
h2 = k.series(e//4,5*e//4,9*e,2)
a20 = exp2a(9*e*e//8,k.a2,p)
c1 = a20[0]
s1 = a20[1]
t24 = (2*h1[0]+h2[0])%p
t25 = (2*h1[1]+h2[1])%p

print("\n \n ^^^^^^^^^^^^^^ t24 = {0}  t25 = {1}".format(t24,t25))



t = 3
m[7] = [0,0, c1,s1+1*(p-1), 0,0, 0,0, c1,s1,
        0,0, 0,2*t,  0,0, 0,0, 0,t]

"""
m[19] = [0,0, 0,1, 0,0, 0,0, 0,0,
        0,0, 0,0,  0,0, 0,0, 0,0]
"""


t = 3*sq3%p
t = 3
m[8] = [0,0, 0,0, 0,0, 0,0, 0,0,
       0,0, 2*t,0,  0,0, 0,0, t,0]



m[9] = [0,0, 0,0, 0,0, 0,0, 0,0,
        0,0, 0,2*t, 0,0, 0,0, 0,t]



m[8] = init2(20)

m[9] = init2(20)




# test 7

e = (p-1)//18
h1 = k.series(3*e//4,7*e//4,3*e,2)
h2 = k.series(3*e//4,7*e//4,9*e,2)
a20 = exp2a(9*e*e//8,k.a2,p)
c1 = a20[0]
s1 = a20[1]
t26 = (2*h1[0]+h2[0])%p
t27 = (2*h1[1]+h2[1])%p

print("\n \n ^^^^^^^^^^^^^^ t26 = {0}  t27 = {1}".format(t26,t27))



t = p-3
m[7] = [c1,s1, 0,0, c1,s1, p+1,0, 0,0,
        t,0, 0,0,  t,0, t,0, 0,0]

"""
m[19] = [0,0, 0,0, 0,0, 1,0, 0,0,
        0,0, 0,0,  0,0, 0,0, 0,0]
"""


t = 3*sq3%p
t = 3
m[8] = [0,0, 0,0, 0,0, 0,0, 0,0,
        t,0, 0,0,  t,0, t,0, 0,0]



m[9] = [0,0, 0,0, 0,0, 0,0, 0,0,
        0,t, 0,0, 0,t, 0,t, 0,0]



m[8] = init2(20)

m[9] = init2(20)



b2 = init2(30)
for i in range(30):
    b2[i] = multcnvl2(m[i],k20,p)


s3 = sq3
q1 = (p-1)//9
print("\n \n q1 = {0}  q1 mod 9 = {1}".format(q1,q1%9))
a3 = exp2a(2*q1*q1,k.a2,p)
t1 = (p+a3[0])%p
t1 = (t1+(p-1))%p
t2 = (p+a3[1])%p
t3 = 2*a3[0]%p
t4 = 2*a3[1]%p
t5 = 7*inverse(4,p)%p
t6 = s3*inverse(4,p)%p
a4 = exp2a(2,a3,p)
t7 = ((p-1)*t6+a4[1])%p
t8 = (t5+(p-1)+(p-a4[0]))%p
t = (p-1)//2
t9 = (t*a3[0]+t+1)%p
t10 = (t+1)*a3[1]%p
t11 = ((p-1)*t10+3*s3*(t+1))%p
t12 = t*a3[0]%p
b3 = [1,1,0,t1,t2,t3,t4,0,0,0,
      t5,t6,t7,t8,t9,t10,t11,t12,0,0]


print("\n \n b2 = ",b2[:10],"\n      ",b2[10:20],"\n      ",b2[20:])

print("\n \n b3 = ",b3[:10],"\n      ",b3[10:20])


v1 = init2(30)

print("\n \n")
display(0,29,0,19,m,v1)

h1 = init2(30)

solve2(20,m,v1,p)
t1 = det(20,m)
print("\n \n det = ",t1)
display(0,19,0,19,m,v1)
l2solve(20,h1,v1,m,p)
print("after solve2 = ",h1)
print("\n \n")


# k.list2(9,2)
# k1.list1(3,2,(p-1)//18)
# k2.list1(9,2,(p-1)//18)

